<% if flash[:notice] %>
    <div class="alert alert-success" role="alert">
        <%= flash[:notice] %>
    </div>

<% end %>

<%= form_tag(busca_produto_path, method: :get) do %>
    <div class="form-group">
        <%= text_field_tag(:texto_busca, @texto_busca, class:"form-control") %>
        <%= button_to "Buscar", nil, class:"btn btn-default" %>
    </div>
<% end %>

<table class="table table-bordered table-hover">
    <thead>
        <tr>
            <td>Nome</td>
            <td>Descrição</td>
            <td>Departamento</td>
            <td>Preço</td>
            <td>Quantidade</td>
            <td colspan="2">
        </tr>
    </thead>
    <tbody>
    <% @todos_produtos.each do |produto| %>
        <tr>
            <td><%= produto.nome %></td>
            <td><%= produto.descricao %></td>
            <td><%= produto.departamento.nome%></td>
            <td><%= produto.preco %></td>
            <td><%= produto.quantidade %></td>
            <td><%= button_to(
                "Remover", 
                produto_path(produto.id),
                {   method: "delete", 
                    class: "btn btn-danger",
                    data: {confirm: "Tem certeza que deseja remover o produto #{produto.nome}? "} 
                }
            ) %></td>
            <td><%= link_to  "Alterar", edit_produto_path(produto), class:"btn btn-default" %></td>
        </tr>
    <% end %>
    </tbody>
</table>

<div class="alert alert-success" role="alert">
    <h4 class="alert-heading">Produto mais barato</h4>
</div>

<table class="table table-bordered table-hover">
    <thead>
        <tr>
            <td>Nome</td>
            <td>Descrição</td>
            <td>Departamento</td>
            <td>Preço</td>
            <td>Quantidade</td>
        </tr>
    </thead>
    <tbody>
    <% @produto_mais_barato.each do |produto| %>
        <tr>
            <td><%= produto.nome %></td>
            <td><%= produto.descricao %></td>
            <td><%= produto.departamento.nome%></td>
            <td><%= produto.preco %></td>
            <td><%= produto.quantidade %></td>
        </tr>
    <% end %>
    </tbody>
</table>
